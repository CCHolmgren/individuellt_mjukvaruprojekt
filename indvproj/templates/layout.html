<!DOCTYPE html>
{%- from "_formhelpers.html" import render_post, render_collection_dense with context %}
<html>
<head>
    <title>{{ title }}</title>
    {% block head %}{% endblock %}
    <link rel=stylesheet type=text/css href="{{ url_for('static',filename='style.css') }}">
</head>
<body>
<div class="head">
    <a href={{ url_for('MainView:index') }}>Home</a>

    <div class="signinbar">
        {% if not g.user.is_active() %}
            <p>Do you want to <a href={{ url_for('RegisterView:new_user') }}> register</a> or <a
                    href={{ url_for('LoginView:index') }}>login</a>?</p>
        {% else %}
            <a href={{ url_for('LogoutView:logout') }}>Log out</a>
            <a href={{ url_for('UserView:get',username= g.user.username) }}>{{ g.user.username }}</a>
    {% endif %}
    </div>
</div>
<div class="messages">
    {%- with messages = get_flashed_messages() %}
        {%- if messages %}
            <ul class=flashes>
                {%- for message in messages %}
                    <li>{{ message }}</li>
                {%- endfor %}
            </ul>
        {%- endif %}
    {%- endwith %}
</div>
<div class="toleftside">
    <div>
        {% if g.user.is_active() %}
            {% if g.user.collections %}
            All your collections:
            {% for collection in g.user.collections.all() %}
                {{ render_collection_dense(collection) }}
            {% endfor %}
        {% else %}
            You haven't got any collections
        {% endif %}
        {% endif %}
    </div>
    <div>
        All users:
        {% for user in g.users %}
            <div>{{ user.username }}</div>
        {% endfor %}
    </div>
    <div class="categories">
        <p>Categories:</p>
        {% for category in g.categories %}
            <div>
                <a href={{ url_for('CategoryView:get', categoryname=category.categoryname) }}>{{ category.categoryname }}</a>
                {% if category.moderators.all() %}
                    <div>
                        <small>Moderators:
                            {% for moderator in category.moderators.all() %}
                                <a href={{ url_for('UserView:get',username=moderator.username) }}>{{ moderator.username }}</a>
                            {% endfor %}
                        </small>
                    </div>
                {% endif %}
            </div>
        {% endfor %}
    </div>
</div>
<div class="main">
    {%- block body %}{%- endblock %}
</div>
</body>
</html>